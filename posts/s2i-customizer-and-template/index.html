<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>S2I自定义构建器和模板 - 蜷缩的蜗牛</title><meta name=author content="kbsonlong">
<meta name=description content="准备工作 S2I自定义镜像构建器 ● assemble（必需）：从源代码构建应用程序制品的脚本 assemble。 ● run（必需）：用于运行应用程序的脚本。 ● save-artifacts（可选）：管理增量构建过程中的所有依赖。 ● usage（可选）：提供说明的脚本。 ● test （可选）：用于测试的脚本。
"><meta name=keywords content='kubesphere,operator'><meta itemprop=name content="S2I自定义构建器和模板"><meta itemprop=description content="准备工作 S2I自定义镜像构建器 ● assemble（必需）：从源代码构建应用程序制品的脚本 assemble。 ● run（必需）：用于运行应用程序的脚本。 ● save-artifacts（可选）：管理增量构建过程中的所有依赖。 ● usage（可选）：提供说明的脚本。 ● test （可选）：用于测试的脚本。"><meta itemprop=datePublished content="2022-09-11T10:31:24+08:00"><meta itemprop=dateModified content="2022-09-11T10:31:24+08:00"><meta itemprop=wordCount content="3403"><meta itemprop=image content="https://www.kbsonlong.com/logo_transparent.png"><meta itemprop=keywords content="Kubesphere,Operator"><meta property="og:url" content="https://www.kbsonlong.com/posts/s2i-customizer-and-template/"><meta property="og:site_name" content="蜷缩的蜗牛"><meta property="og:title" content="S2I自定义构建器和模板"><meta property="og:description" content="准备工作 S2I自定义镜像构建器 ● assemble（必需）：从源代码构建应用程序制品的脚本 assemble。 ● run（必需）：用于运行应用程序的脚本。 ● save-artifacts（可选）：管理增量构建过程中的所有依赖。 ● usage（可选）：提供说明的脚本。 ● test （可选）：用于测试的脚本。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-11T10:31:24+08:00"><meta property="article:modified_time" content="2022-09-11T10:31:24+08:00"><meta property="article:tag" content="Kubesphere"><meta property="article:tag" content="Operator"><meta property="og:image" content="https://www.kbsonlong.com/logo_transparent.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.kbsonlong.com/logo_transparent.png"><meta name=twitter:title content="S2I自定义构建器和模板"><meta name=twitter:description content="准备工作 S2I自定义镜像构建器 ● assemble（必需）：从源代码构建应用程序制品的脚本 assemble。 ● run（必需）：用于运行应用程序的脚本。 ● save-artifacts（可选）：管理增量构建过程中的所有依赖。 ● usage（可选）：提供说明的脚本。 ● test （可选）：用于测试的脚本。"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#ffffff data-dark=#252627 content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ title="S2I自定义构建器和模板 - 蜷缩的蜗牛"><link rel=prev type=text/html href=https://www.kbsonlong.com/posts/gin-middleware-execution-order/ title=Gin中间件执行顺序><link rel=next type=text/html href=https://www.kbsonlong.com/posts/vscode-configuration-markdown-template/ title="VSCode 配置Markdown模板"><link rel=alternate type=text/markdown href=https://www.kbsonlong.com/posts/s2i-customizer-and-template/index.md title="S2I自定义构建器和模板 - 蜷缩的蜗牛"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"S2I自定义构建器和模板","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.kbsonlong.com\/posts\/s2i-customizer-and-template\/"},"genre":"posts","keywords":"kubesphere, operator","wordcount":3403,"url":"https:\/\/www.kbsonlong.com\/posts\/s2i-customizer-and-template\/","datePublished":"2022-09-11T10:31:24+08:00","dateModified":"2022-09-11T10:31:24+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"kbsonlong"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title=蜷缩的蜗牛><img class=logo src=/logo_transparent.png alt=蜷缩的蜗牛 height=32 width=32><span class=header-title-text>蜷缩的蜗牛</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class='fa-solid fa-archive fa-fw fa-sm'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class='fa-solid fa-users fa-fw fa-sm'></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class='fa-solid fa-info-circle fa-fw fa-sm'></i> 关于</a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=https://github.com/kbsonlong/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw'></i></a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=/messages/><i class='fa-solid fa-messages'></i> 留言板</a></li><li class=menu-item><a class=menu-link href=/messages/ title=留言板>留言板</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language-switch"><span role=button aria-label=选择语言 title=选择语言><i class="fa-solid fa-language fa-fw" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=蜷缩的蜗牛><img class=logo src=/logo_transparent.png alt=蜷缩的蜗牛 height=26 width=26><span class=header-title-text>蜷缩的蜗牛</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class='fa-solid fa-archive fa-fw fa-sm'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class='fa-solid fa-users fa-fw fa-sm'></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class='fa-solid fa-info-circle fa-fw fa-sm'></i> 关于</a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=https://github.com/kbsonlong/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw'></i></a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=/messages/><i class='fa-solid fa-messages'></i> 留言板</a></li><li class=menu-item><a class=menu-link href=/messages/ title=留言板>留言板</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span><span class="menu-system-item language-switch">
<span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>S2I自定义构建器和模板</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
kbsonlong</span></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/ class=post-category title="分类 - 云原生"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 云原生</a></span></div><div class=post-meta-line><span title="发布于 2022-09-11 10:31:24"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2022-09-11>2022-09-11</time></span>&nbsp;<span title="3403 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 3500 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 7 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=S2I自定义构建器和模板><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#准备工作>准备工作</a><ul><li><a href=#s2i自定义镜像构建器>S2I自定义镜像构建器</a></li></ul></li><li><a href=#创建镜像构建器>创建镜像构建器</a><ul><li><a href=#准备s2i目录>准备S2I目录</a></li></ul></li><li><a href=#修改dockerfile>修改Dockerfile</a></li><li><a href=#修改s2i脚本>修改S2I脚本</a><ul><li><a href=#assemble>assemble</a></li><li><a href=#run>run</a></li></ul></li><li><a href=#构建与运行>构建与运行</a><ul><li><a href=#创建镜像构建器-1>创建镜像构建器</a></li><li><a href=#使用镜像构建器创建应用程序镜像>使用镜像构建器创建应用程序镜像</a></li><li><a href=#测试运行应用程序镜像>测试运行应用程序镜像</a></li></ul></li><li><a href=#自定义s2i模板>自定义S2I模板</a><ul><li><a href=#官方demo>官方demo</a></li></ul></li><li><a href=#参考资料>参考资料</a></li></ul></li></ul></nav></div></div><div class=content id=content><h3 class=heading-element id=准备工作><span>准备工作</span>
<a href=#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=s2i自定义镜像构建器><span>S2I自定义镜像构建器</span>
<a href=#s2i%e8%87%aa%e5%ae%9a%e4%b9%89%e9%95%9c%e5%83%8f%e6%9e%84%e5%bb%ba%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>● assemble（必需）：从源代码构建应用程序制品的脚本 assemble。
● run（必需）：用于运行应用程序的脚本。
● save-artifacts（可选）：管理增量构建过程中的所有依赖。
● usage（可选）：提供说明的脚本。
● test （可选）：用于测试的脚本。</p><h3 class=heading-element id=创建镜像构建器><span>创建镜像构建器</span>
<a href=#%e5%88%9b%e5%bb%ba%e9%95%9c%e5%83%8f%e6%9e%84%e5%bb%ba%e5%99%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=准备s2i目录><span>准备S2I目录</span>
<a href=#%e5%87%86%e5%a4%87s2i%e7%9b%ae%e5%bd%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ol><li>安装s2i</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/openshift/source-to-image/releases/download/v1.2.04/source-to-image-v1.1.14-874754de-linux-386.tar.gz
</span></span><span class=line><span class=cl> tar -xvf source-to-image-v1.1.14-874754de-linux-386.tar.gz
</span></span><span class=line><span class=cl> ls
</span></span><span class=line><span class=cl>s2i source-to-image-v1.1.14-874754de-linux-386.tar.gz  sti
</span></span><span class=line><span class=cl> cp s2i /usr/local/bin</span></span></code></pre></td></tr></table></div></div><ol start=2><li>初始化镜像构建器</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>s2i create java-ubuntu22 java-ubuntu22
</span></span><span class=line><span class=cl><span class=nb>cd</span> java-ubuntu22</span></span></code></pre></td></tr></table></div></div><ol start=3><li>目录结构初始化</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── Dockerfile
</span></span><span class=line><span class=cl>├── Makefile
</span></span><span class=line><span class=cl>├── README.md
</span></span><span class=line><span class=cl>├── prometheus-config.yml
</span></span><span class=line><span class=cl>├── s2i
</span></span><span class=line><span class=cl>│   └── bin
</span></span><span class=line><span class=cl>│       ├── assemble
</span></span><span class=line><span class=cl>│       ├── run
</span></span><span class=line><span class=cl>│       ├── save-artifacts
</span></span><span class=line><span class=cl>│       └── usage
</span></span><span class=line><span class=cl>└── <span class=nb>test</span>
</span></span><span class=line><span class=cl>    ├── run
</span></span><span class=line><span class=cl>    └── test-app
</span></span><span class=line><span class=cl>        ├── b2i-jar-java8.jar  <span class=c1>## 默认不存在</span>
</span></span><span class=line><span class=cl>        └── index.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>4</span> directories, <span class=m>11</span> files</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=修改dockerfile><span>修改Dockerfile</span>
<a href=#%e4%bf%ae%e6%94%b9dockerfile class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># java-ubuntu22</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> ubuntu:22.04 </span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Put the maintainer name in the image metadata</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># LABEL maintainer=&#34;Your Name &lt;your@email.com&gt;&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Rename the builder environment variable to inform users about application you provide them</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ENV BUILDER_VERSION 1.0</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Set labels used in OpenShift to describe the builder image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>LABEL</span> io.k8s.description<span class=o>=</span><span class=s2>&#34;Java 8 web application&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    io.k8s.display-name<span class=o>=</span><span class=s2>&#34;Java 8 Web&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    io.openshift.expose-services<span class=o>=</span><span class=s2>&#34;8080:http&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    io.openshift.tags<span class=o>=</span><span class=s2>&#34;builder,java,web&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=c1># this label tells s2i where to find its mandatory scripts</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=c1># (run, assemble, save-artifacts)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    io.openshift.s2i.scripts-url<span class=o>=</span><span class=s2>&#34;image:///usr/libexec/s2i&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Install required packages here:</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># RUN yum install -y ... &amp;&amp; yum clean all -y</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> apt-get install -y <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    curl <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    wget <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openjdk-8-jdk <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    rm -rf /var/lib/apt/lists<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /opt</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO (optional): Copy the builder files into /opt/app-root</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># COPY ./&lt;builder_folder&gt;/ /opt/app-root/</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Copy the S2I scripts to /usr/libexec/s2i, since openshift/base-centos7 image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># sets io.openshift.s2i.scripts-url label that way, or update that label</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./s2i/bin/ /usr/libexec/s2i<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Drop the root user and make the content of /opt/app-root owned by user 1001</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># RUN chown -R 1001:1001 /opt/app-root</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chgrp -R <span class=m>0</span> /usr/libexec/s2i <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=o>&amp;&amp;</span> chmod -R <span class=nv>u</span><span class=o>=</span>rwx,go<span class=o>=</span>rx /usr/libexec/s2i <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  chgrp -R <span class=m>0</span> /opt <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=o>&amp;&amp;</span> chmod -R <span class=nv>u</span><span class=o>=</span>rwx,go<span class=o>=</span>rx /opt <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  chown -R 1001:1001 /opt <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  chown -R 1001:1001 /usr/libexec/s2i/assemble<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> mkdir -p /opt/prometheus/etc <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=o>&amp;&amp;</span> curl https://repo1.maven.org/maven2/io/prometheus/jmx/jmx_prometheus_javaagent/0.17.0/jmx_prometheus_javaagent-0.17.0.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>          -o /opt/prometheus/jmx_prometheus_javaagent.jar<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> prometheus-config.yml /opt/prometheus/etc <span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># This default user is created in the openshift/base-centos7 image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> 1001</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Set the default port for applications built using this image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># TODO: Set the default CMD for the image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;/usr/libexec/s2i/usage&#34;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=修改s2i脚本><span>修改S2I脚本</span>
<a href=#%e4%bf%ae%e6%94%b9s2i%e8%84%9a%e6%9c%ac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=assemble><span>assemble</span>
<a href=#assemble class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash -e
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># S2I assemble script for the &#39;java-ubuntu22&#39; image.</span>
</span></span><span class=line><span class=cl><span class=c1># The &#39;assemble&#39; script builds your application source so that it is ready to run.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># For more information refer to the documentation:</span>
</span></span><span class=line><span class=cl><span class=c1>#	https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If the &#39;java-ubuntu22&#39; assemble script is executed with the &#39;-h&#39; flag, print the usage.</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;-h&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=nb>exec</span> /usr/libexec/s2i/usage
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Restore artifacts from the previous build (if they exist).</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;---&gt; Installing application...&#34;</span>
</span></span><span class=line><span class=cl>mkdir -p /opt/app
</span></span><span class=line><span class=cl>ls /tmp/src/*
</span></span><span class=line><span class=cl>mv /tmp/src/* /opt/app/
</span></span><span class=line><span class=cl>chmod +x /opt/app/*.jar</span></span></code></pre></td></tr></table></div></div><blockquote><p>默认情况下，s2i build将应用程序源代码放在/tmp/src。上述命令将应用程序jar包复制到/opt/app/目录下</p></blockquote><h4 class=heading-element id=run><span>run</span>
<a href=#run class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash -e
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># S2I run script for the &#39;java-ubuntu22&#39; image.</span>
</span></span><span class=line><span class=cl><span class=c1># The run script executes the server that runs your application.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># For more information see the documentation:</span>
</span></span><span class=line><span class=cl><span class=c1>#	https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>PROMETHEUS_JMX_OPTS</span><span class=o>=</span><span class=s2>&#34;-javaagent:/opt/prometheus/jmx_prometheus_javaagent.jar=</span><span class=si>${</span><span class=nv>PROMETHEUS_JMX_PORT</span><span class=si>}</span><span class=s2>:/opt/prometheus/etc/prometheus-config.yml&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Always include jolokia-opts, which can be empty if switched off via env</span>
</span></span><span class=line><span class=cl><span class=nv>JAVA_OPTIONS</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>JAVA_OPTIONS</span><span class=p>:+</span><span class=si>${</span><span class=nv>JAVA_OPTIONS</span><span class=si>}</span><span class=p> </span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Temporary options variable until the harmonization hawt-app PR #5 has been applied (hopefully)</span>
</span></span><span class=line><span class=cl><span class=nv>JVM_ARGS</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>JVM_ARGS</span><span class=p>:+</span><span class=si>${</span><span class=nv>JVM_ARGS</span><span class=si>}</span><span class=p> </span><span class=si>}${</span><span class=nv>JAVA_OPTIONS</span><span class=si>}</span><span class=s2> </span><span class=si>${</span><span class=nv>PROMETHEUS_JMX_OPTS</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> JAVA_OPTIONS JVM_ARGS PROMETHEUS_JMX_OPTS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>exec</span> java -jar <span class=si>${</span><span class=nv>JVM_ARGS</span><span class=si>}</span> /opt/app/app.jar</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=构建与运行><span>构建与运行</span>
<a href=#%e6%9e%84%e5%bb%ba%e4%b8%8e%e8%bf%90%e8%a1%8c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=创建镜像构建器-1><span>创建镜像构建器</span>
<a href=#%e5%88%9b%e5%bb%ba%e9%95%9c%e5%83%8f%e6%9e%84%e5%bb%ba%e5%99%a8-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>make build </span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=使用镜像构建器创建应用程序镜像><span>使用镜像构建器创建应用程序镜像</span>
<a href=#%e4%bd%bf%e7%94%a8%e9%95%9c%e5%83%8f%e6%9e%84%e5%bb%ba%e5%99%a8%e5%88%9b%e5%bb%ba%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e9%95%9c%e5%83%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># s2i build ./test/test-app  java-ubuntu22 sample-app                           </span>
</span></span><span class=line><span class=cl>---&gt; Installing application...
</span></span><span class=line><span class=cl>/tmp/src/b2i-jar-java8.jar
</span></span><span class=line><span class=cl>/tmp/src/index.html
</span></span><span class=line><span class=cl>Build completed successfully</span></span></code></pre></td></tr></table></div></div><blockquote><p>按照assemble脚本定义的逻辑，S2I使用镜像构建器作为基础创建应用程序镜像，并从test/test-app目录注入源代码。</p></blockquote><h4 class=heading-element id=测试运行应用程序镜像><span>测试运行应用程序镜像</span>
<a href=#%e6%b5%8b%e8%af%95%e8%bf%90%e8%a1%8c%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e9%95%9c%e5%83%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> <span class=c1># docker run -p 8080:8080 -p 12345:12345 -e PROMETHEUS_JMX_PORT=12345  sample-app</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  .   ____          _            __ _ _
</span></span><span class=line><span class=cl> /<span class=se>\\</span> / ___<span class=s1>&#39;_ __ _ _(_)_ __  __ _ \ \ \ \
</span></span></span><span class=line><span class=cl><span class=s1>( ( )\___ | &#39;</span>_ <span class=p>|</span> <span class=s1>&#39;_| | &#39;</span>_ <span class=se>\/</span> _<span class=sb>`</span> <span class=p>|</span> <span class=se>\ \ \ \
</span></span></span><span class=line><span class=cl><span class=se></span> <span class=se>\\</span>/  ___<span class=o>)</span><span class=p>|</span> <span class=p>|</span>_<span class=o>)</span><span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=o>||</span> <span class=o>(</span>_<span class=p>|</span> <span class=p>|</span>  <span class=o>)</span> <span class=o>)</span> <span class=o>)</span> <span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;  |____| .__|_| |_|_| |_\__, | / / / /
</span></span></span><span class=line><span class=cl><span class=s1> =========|_|==============|___/=/_/_/_/
</span></span></span><span class=line><span class=cl><span class=s1> :: Spring Boot ::  (v1.4.1.BUILD-SNAPSHOT)
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:48.829  INFO 1 --- [           main] io.kubesphere.devops.Application         : Starting Application v0.0.1-SNAPSHOT on 322634c30cc2 with PID 1 (/opt/app/app.jar started by ? in /opt)
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:48.839  INFO 1 --- [           main] io.kubesphere.devops.Application         : No active profile set, falling back to default profiles: default
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:48.906  INFO 1 --- [           main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@5ae50ce6: startup date [Thu Jul 28 07:51:48 GMT 2022]; root of context hierarchy
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.694  INFO 1 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat initialized with port(s): 8080 (http)
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.700  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Starting service Tomcat
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.701  INFO 1 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/8.5.5
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.749  INFO 1 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.749  INFO 1 --- [ost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 845 ms
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.820  INFO 1 --- [ost-startStop-1] o.s.b.w.servlet.ServletRegistrationBean  : Mapping servlet: &#39;</span>dispatcherServlet<span class=s1>&#39; to [/]
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.822  INFO 1 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: &#39;</span>characterEncodingFilter<span class=s1>&#39; to: [/*]
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.822  INFO 1 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: &#39;</span>hiddenHttpMethodFilter<span class=s1>&#39; to: [/*]
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.823  INFO 1 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: &#39;</span>httpPutFormContentFilter<span class=s1>&#39; to: [/*]
</span></span></span><span class=line><span class=cl><span class=s1>2022-07-28 07:51:49.823  INFO 1 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: &#39;</span>requestContextFilter<span class=err>&#39;</span> to: <span class=o>[</span>/*<span class=o>]</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:49.988  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> s.w.s.m.m.a.RequestMappingHandlerAdapter : Looking <span class=k>for</span> @ControllerAdvice: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@5ae50ce6: startup date <span class=o>[</span>Thu Jul <span class=m>28</span> 07:51:48 GMT 2022<span class=o>]</span><span class=p>;</span> root of context hierarchy
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.047  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped <span class=s2>&#34;{[/]}&#34;</span> onto public java.lang.String io.kubesphere.devops.HelloWorldController.sayHello<span class=o>()</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.050  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped <span class=s2>&#34;{[/error],produces=[text/html]}&#34;</span> onto public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.BasicErrorController.errorHtml<span class=o>(</span>javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.050  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped <span class=s2>&#34;{[/error]}&#34;</span> onto public org.springframework.http.ResponseEntity&lt;java.util.Map&lt;java.lang.String, java.lang.Object&gt;&gt; org.springframework.boot.autoconfigure.web.BasicErrorController.error<span class=o>(</span>javax.servlet.http.HttpServletRequest<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.063  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path <span class=o>[</span>/webjars/**<span class=o>]</span> onto handler of <span class=nb>type</span> <span class=o>[</span>class org.springframework.web.servlet.resource.ResourceHttpRequestHandler<span class=o>]</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.063  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path <span class=o>[</span>/**<span class=o>]</span> onto handler of <span class=nb>type</span> <span class=o>[</span>class org.springframework.web.servlet.resource.ResourceHttpRequestHandler<span class=o>]</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.081  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path <span class=o>[</span>/**/favicon.ico<span class=o>]</span> onto handler of <span class=nb>type</span> <span class=o>[</span>class org.springframework.web.servlet.resource.ResourceHttpRequestHandler<span class=o>]</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.153  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> o.s.j.e.a.AnnotationMBeanExporter        : Registering beans <span class=k>for</span> JMX exposure on startup
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.176  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port<span class=o>(</span>s<span class=o>)</span>: <span class=m>8080</span> <span class=o>(</span>http<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-07-28 07:51:50.178  INFO <span class=m>1</span> --- <span class=o>[</span>           main<span class=o>]</span> io.kubesphere.devops.Application         : Started Application in 1.6 seconds <span class=o>(</span>JVM running <span class=k>for</span> 2.063<span class=o>)</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>8080是java程序定义的端口，12345是jmx_prometheus_agent定义的端口</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># curl http://localhost:12345|more</span>
</span></span><span class=line><span class=cl>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class=line><span class=cl>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class=line><span class=cl><span class=m>100</span> <span class=m>11008</span>  <span class=m>100</span> <span class=m>11008</span>    <span class=m>0</span>     <span class=m>0</span>  <span class=m>54117</span>      <span class=m>0</span> --:--:-- --:--:-- --:--:-- <span class=m>56163</span>
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_memory_pool_allocated_bytes_total Total bytes allocated in a given JVM memory pool. Only updated after GC, not continuously.</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_memory_pool_allocated_bytes_total counter</span>
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;Code Cache&#34;</span>,<span class=o>}</span> 1.1579328E7
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;PS Eden Space&#34;</span>,<span class=o>}</span> 5.42141224E8
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;PS Old Gen&#34;</span>,<span class=o>}</span> 1.2845896E7
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;PS Survivor Space&#34;</span>,<span class=o>}</span> 2.0936672E7
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;Compressed Class Space&#34;</span>,<span class=o>}</span> 3700680.0
</span></span><span class=line><span class=cl>jvm_memory_pool_allocated_bytes_total<span class=o>{</span><span class=nv>pool</span><span class=o>=</span><span class=s2>&#34;Metaspace&#34;</span>,<span class=o>}</span> 3.0138704E7
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_current Current thread count of a JVM</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_current gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_current 17.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_daemon Daemon thread count of a JVM</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_daemon gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_daemon 15.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_peak Peak thread count of a JVM</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_peak gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_peak 17.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_started_total Started thread count of a JVM</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_started_total counter</span>
</span></span><span class=line><span class=cl>jvm_threads_started_total 20.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_deadlocked Cycles of JVM-threads that are in deadlock waiting to acquire object monitors or ownable synchronizers</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_deadlocked gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_deadlocked 0.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_deadlocked_monitor Cycles of JVM-threads that are in deadlock waiting to acquire object monitors</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_deadlocked_monitor gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_deadlocked_monitor 0.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_threads_state Current count of threads by state</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_threads_state gauge</span>
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;NEW&#34;</span>,<span class=o>}</span> 0.0
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;TIMED_WAITING&#34;</span>,<span class=o>}</span> 7.0
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;BLOCKED&#34;</span>,<span class=o>}</span> 0.0
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;RUNNABLE&#34;</span>,<span class=o>}</span> 8.0
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;WAITING&#34;</span>,<span class=o>}</span> 2.0
</span></span><span class=line><span class=cl>jvm_threads_state<span class=o>{</span><span class=nv>state</span><span class=o>=</span><span class=s2>&#34;TERMINATED&#34;</span>,<span class=o>}</span> 0.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_classes_currently_loaded The number of classes that are currently loaded in the JVM</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_classes_currently_loaded gauge</span>
</span></span><span class=line><span class=cl>jvm_classes_currently_loaded 5736.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_classes_loaded_total The total number of classes that have been loaded since the JVM has started execution</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE jvm_classes_loaded_total counter</span>
</span></span><span class=line><span class=cl>jvm_classes_loaded_total 5736.0
</span></span><span class=line><span class=cl><span class=c1># HELP jvm_classes_unloaded_total The total number of classes that have been unloaded since the JVM has started execution</span>
</span></span><span class=line><span class=cl><span class=c1># curl http://localhost:8080      </span>
</span></span><span class=line><span class=cl>Hello,World!%    </span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=自定义s2i模板><span>自定义S2I模板</span>
<a href=#%e8%87%aa%e5%ae%9a%e4%b9%89s2i%e6%a8%a1%e6%9d%bf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>devops.kubesphere.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>S2iBuilderTemplate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>controller-tools.k8s.io</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>builder-type.kubesphere.io/s2i</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s2i&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>java-ubuntu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containerInfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>builderImage</span><span class=p>:</span><span class=w> </span><span class=l>java-ubuntu22 </span><span class=w> </span><span class=c>## 自定义的镜像构建器镜像</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>codeFramework</span><span class=p>:</span><span class=w> </span><span class=l>java</span><span class=w> </span><span class=c># type of code framework</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>defaultBaseImage</span><span class=p>:</span><span class=w> </span><span class=l>java-ubuntu22</span><span class=w> </span><span class=c># default Image Builder (can be replaced by a customized image)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.0.1</span><span class=w> </span><span class=c># Builder template version</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;模板描述&#34;</span><span class=w> </span><span class=c># Builder template description</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f s2ibuildertemplate.yaml</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>标签名称</th><th>选项</th><th>定义</th></tr></thead><tbody><tr><td>builder-type.kubesphere.io/s2i</td><td>&ldquo;s2i&rdquo;</td><td>模板类型为 S2I，基于应用程序源代码构建镜像。</td></tr><tr><td>builder-type.kubesphere.io/b2i</td><td>&ldquo;b2i&rdquo;</td><td>模板类型为 B2I，基于二进制文件或其他制品构建镜像。</td></tr><tr><td>binary-type.kubesphere.io</td><td>&ldquo;jar&rdquo;,&ldquo;war&rdquo;,&ldquo;binary&rdquo;</td><td>该类型为 B2I 类型的补充，在选择 B2I 类型时需要。例如，当提供 Jar 包时，选择 &ldquo;jar&rdquo; 类型。在 KubeSphere v2.1.1 及更高版本，允许自定义 B2I 模板。</td></tr></tbody></table><h4 class=heading-element id=官方demo><span>官方demo</span>
<a href=#%e5%ae%98%e6%96%b9demo class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>devops.kubesphere.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>S2iBuilderTemplate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>descriptionCN</span><span class=p>:</span><span class=w> </span><span class=l>Java 应用的构建器模版。通过该模版可构建出直接运行的应用镜像。</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>descriptionEN</span><span class=p>:</span><span class=w> </span><span class=l>This is a builder template for Java builds whose result can be</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>run directly without any further application server.It&#39;s suited ideally for</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>microservices with a flat classpath (including &#34;far jars&#34;).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>devops.kubesphere.io/s2i-template-url</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/kubesphere/s2i-java-container/blob/master/java/images</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>helm.sh/hook</span><span class=p>:</span><span class=w> </span><span class=l>pre-install</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>binary-type.kubesphere.io</span><span class=p>:</span><span class=w> </span><span class=l>jar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>builder-type.kubesphere.io/b2i</span><span class=p>:</span><span class=w> </span><span class=l>b2i</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>builder-type.kubesphere.io/s2i</span><span class=p>:</span><span class=w> </span><span class=l>s2i</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>controller-tools.k8s.io</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>codeFramework</span><span class=p>:</span><span class=w> </span><span class=l>java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containerInfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>buildVolumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>s2i_java_cache:/tmp/artifacts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>builderImage</span><span class=p>:</span><span class=w> </span><span class=l>kubesphere/java-8-centos7:v3.2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runtimeArtifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=l>/deployments</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runtimeImage</span><span class=p>:</span><span class=w> </span><span class=l>kubesphere/java-8-runtime:v3.2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>buildVolumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>s2i_java_cache:/tmp/artifacts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>builderImage</span><span class=p>:</span><span class=w> </span><span class=l>kubesphere/java-11-centos7:v3.2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runtimeArtifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=l>/deployments</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runtimeImage</span><span class=p>:</span><span class=w> </span><span class=l>kubesphere/java-11-runtime:v3.2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>defaultBaseImage</span><span class=p>:</span><span class=w> </span><span class=l>kubesphere/java-8-centos7:v3.2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>This is a builder template for Java builds whose result can be run</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>directly without any further application server.It&#39;s suited ideally for microservices</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>with a flat classpath (including &#34;far jars&#34;)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Arguments to use when calling Maven, replacing the default package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>hawt-app:build -DskipTests -e. Please be sure to run the hawt-app:build goal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>(when not already bound to the package execution phase), otherwise the startup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>scripts won&#39;t work.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>MAVEN_ARGS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Additional Maven arguments, useful for temporary adding arguments</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>like -X or -am -pl .</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>MAVEN_ARGS_APPEND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>With Repositories you specify from which locations you want to download</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>certain artifacts, such as dependencies and maven-plugins.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>MAVEN_MIRROR_URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>If set then the Maven repository is removed after the artifact is</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>built. This is useful for keeping the created application image small, but prevents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>incremental builds. The default is false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>MAVEN_CLEAR_REPO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>boolean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Path to target/ where the jar files are created for multi module</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>builds. These are added to ${MAVEN_ARGS}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>ARTIFACT_DIR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Arguments to use when copying artifacts from the output dir to the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>application dir. Useful to specify which artifacts will be part of the image.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>It defaults to -r hawt-app/* when a hawt-app dir is found on the build directory,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>otherwise jar files only will be included (*.jar).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>ARTIFACT_COPY_ARGS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>the directory where the application resides. All paths in your application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>are relative to this directory. By default it is the same directory where this</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>startup script resides.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_APP_DIR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>directory holding the Java jar files as well an optional classpath</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>file which holds the classpath. Either as a single line classpath (colon separated)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>or with jar files listed line-by-line. If not set JAVA_LIB_DIR is the same as</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>JAVA_APP_DIR.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_LIB_DIR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>options to add when calling java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_OPTIONS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>a number &gt;= 7. If the version is set then only options suitable for</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>this version are used. When set to 7 options known only to Java &gt; 8 will be</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>removed. For versions &gt;= 10 no explicit memory limit is calculated since Java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>&gt;= 10 has support for container limits.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_MAJOR_VERSION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>is used when no -Xmx option is given in JAVA_OPTIONS. This is used</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>to calculate a default maximal Heap Memory based on a containers restriction.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>If used in a Docker container without any memory constraints for the container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>then this option has no effect. If there is a memory constraint then -Xmx is</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>set to a ratio of the container available memory as set here. The default is</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=m>25</span><span class=w> </span><span class=l>when the maximum amount of memory available to the container is below 300M,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=m>50</span><span class=w> </span><span class=l>otherwise, which means in that case that 50% of the available memory is used</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>as an upper boundary. You can skip this mechanism by setting this value to 0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>in which case no -Xmx option is added.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_MAX_MEM_RATIO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>is used when no -Xms option is given in JAVA_OPTIONS. This is used</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>to calculate a default initial Heap Memory based on a containers restriction.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>If used in a Docker container without any memory constraints for the container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>then this option has no effect. If there is a memory constraint then -Xms is</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>set to a ratio of the container available memory as set here. By default this</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>value is not set.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_INIT_MEM_RATIO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>restrict manually the number of cores available which is used for</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>calculating certain defaults like the number of garbage collector threads. If</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>set to 0 no base JVM tuning based on the number of cores is performed.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_MAX_CORE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>set this to get some diagnostics information to standard out when</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>things are happening</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_DIAGNOSTICS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>main class to use as argument for java. When this environment variable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>is given, all jar files in $JAVA_APP_DIR are added to the classpath as well</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>as $JAVA_LIB_DIR.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_MAIN_CLASS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>A jar file with an appropriate manifest so that it can be started</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>with java -jar if no $JAVA_MAIN_CLASS is set. In all cases this jar file is</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>added to the classpath, too.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_APP_JAR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Name to use for the process</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_APP_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>the classpath to use. If not given, the startup script checks for</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>a file ${JAVA_APP_DIR}/classpath and use its content literally as classpath.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>If this file doesn&#39;t exists all jars in the app dir are added (classes:${JAVA_APP_DIR}/*).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_CLASSPATH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>If set remote debugging will be switched on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_DEBUG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>If set enables suspend mode in remote debugging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_DEBUG_SUSPEND</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description: &#39;Port used for remote debugging. Default</span><span class=p>:</span><span class=w> </span><span class=m>5005</span><span class=l>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_DEBUG_PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The URL of the proxy server that translates into the http.proxyHost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>and http.proxyPort system properties.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>HTTP_PROXY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The URL of the proxy server that translates into the https.proxyHost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>and https.proxyPort system properties.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>HTTPS_PROXY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>defaultValue</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The list of hosts that should be reached directly, bypassing the</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>proxy, that translates into the http.nonProxyHosts system property.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>NO_PROXY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>iconPath</span><span class=p>:</span><span class=w> </span><span class=l>assets/java.png</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.0.2</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=参考资料><span>参考资料</span>
<a href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><a href=https://github.com/kubesphere/s2i-base-container target=_blank rel="external nofollow noopener noreferrer">s2i-base-container</a></p><p><a href=https://github.com/kubesphere/s2i-java-container target=_blank rel="external nofollow noopener noreferrer">s2i-java-container</a></p><p><a href=https://github.com/kubesphere/s2i-java-runtimeImage target=_blank rel="external nofollow noopener noreferrer">s2i-java-runtimeImage</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2022-09-11 10:31:24">更新于 2022-09-11&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/s2i-customizer-and-template/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板 data-hashtags=kubesphere,operator><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-hashtag=kubesphere><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板 data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板><svg class="icon" role="img" viewBox="0 0 24 24"><title>LINE</title><path d="M19.365 9.863c.349.0.63.285.63.631.0.345-.281.63-.63.63H17.61v1.125h1.755c.349.0.63.283.63.63.0.344-.281.629-.63.629h-2.386c-.345.0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346.0.627.285.627.63.0.349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211.0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346.0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195.0.375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345.0.63.285.63.63v4.771zm-5.741.0c0 .344-.282.629-.631.629-.345.0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346.0.628.285.628.63v4.771zm-2.466.629H4.917c-.345.0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348.0.63.285.63.63v4.141h1.756c.348.0.629.283.629.63.0.344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943.0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/></svg></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板 data-description><svg class="icon" role="img" viewBox="0 0 24 24"><title>Myspace</title><path d="M19.802 12.274A3.811 3.811.0 0023.62 8.47c0-2.101-1.71-3.795-3.818-3.795a3.816 3.816.0 00-3.818 3.81 3.817 3.817.0 003.818 3.811zm-8.602.705a3.43 3.43.0 003.435-3.424A3.43 3.43.0 0011.2 6.13 3.44 3.44.0 007.764 9.566 3.436 3.436.0 0011.2 13zm-7.8.635c1.71.0 3.093-1.38 3.093-3.081.0-1.704-1.395-3.084-3.105-3.084A3.086 3.086.0 00.3 10.539c0 1.7 1.387 3.078 3.095 3.078zm0 .705c-1.96.0-3.4 1.717-3.4 3.495v1.196c0 .17.138.31.31.31h6.18a.31.31.0 00.309-.31v-1.196c0-1.779-1.437-3.5-3.398-3.5zm7.8-.56c-2.18.0-3.78 1.915-3.78 3.891v1.331c0 .188.156.344.345.344h6.87a.344.344.0 00.342-.344V17.65c0-1.976-1.598-3.891-3.777-3.891zm8.602-.617c-2.422.0-4.197 2.126-4.197 4.323v1.477c0 .21.172.381.382.381h7.63c.21.0.383-.171.383-.381v-1.477c-.001-2.197-1.776-4.323-4.198-4.323z"/></svg></a>
<a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板 data-description><i class="fa-brands fa-blogger fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://www.kbsonlong.com/posts/s2i-customizer-and-template/ data-title=S2I自定义构建器和模板><i class="fa-brands fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/kubesphere/ class=post-tag title="标签 - Kubesphere">Kubesphere</a><a href=/tags/operator/ class=post-tag title="标签 - Operator">Operator</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/gin-middleware-execution-order/ class=post-nav-item rel=prev title=Gin中间件执行顺序><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Gin中间件执行顺序</a><a href=/posts/vscode-configuration-markdown-template/ class=post-nav-item rel=next title="VSCode 配置Markdown模板">VSCode 配置Markdown模板<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=kbsonlong/sre data-repo-id=R_kgDOMFzwNA data-category=Announcements data-category-id=DIC_kwDOMFzwNM4Cn0gn data-mapping=title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=/></a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div><div class="footer-line beian"><span class="icp footer-divider"><a target=_blank href=https://beian.miit.gov.cn/>粤ICP备18122209号</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/kbsonlong title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=preload href=/lib/katex/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/katex/katex.min.css></noscript><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=https://vercount.one/js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark",lightTheme:"light",origin:"https://giscus.app"}},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{algoliaAppID:"WFOR67TML1",algoliaIndex:"along",algoliaSearchKey:"ea1fe535f9a7ae353f3922489c829cc1",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},siteTime:"2018-12-18T16:15:22+08:00",version:"v0.3.20",watermark:{appendto:".wrapper>main",colspacing:30,content:'<img class="fixit-icon" src="/favicon-16x16.png" alt="FixIt logo" /> FixIt 主题',enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/js/theme.min.js defer></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","6272760969",{anonymize_ip:!0})</script><script src="https://www.googletagmanager.com/gtag/js?id=6272760969" async></script></body></html>